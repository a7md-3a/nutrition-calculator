<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø­Ø§Ø³Ø¨Ø© Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ ØªÙØµÙŠÙ„ÙŠ 30 ÙŠÙˆÙ…</title>
<!-- Bootstrap RTL (CDN) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet" />
<style>
  body{
    background:#f4f7fb;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    color:#222;
    padding:18px;
  }
  .card-day{
    border-radius:12px;
    box-shadow:0 6px 24px rgba(11,116,222,0.08);
    overflow:hidden;
    margin-bottom:18px;
  }
  .meal-title{font-weight:700;color:#0b74de}
  .kcal-badge{font-weight:700;color:#0b74de}
  .sidebar-sample{background:#0b74de;color:#fff;padding:18px;border-radius:12px;height:100%}
  .app-header{display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:18px}
  .app-logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#0b74de,#2db7f5);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900;font-size:20px}
  /* responsive grid */
  @media(min-width:1000px){
    .layout {display:grid;grid-template-columns:280px 1fr;gap:22px;}
  }
  .result-area{max-height:620px;overflow:auto;padding:0 8px;}
  .food-img{width:100%;height:120px;object-fit:cover;border-bottom:1px solid rgba(0,0,0,0.06)}
  .meal-item{display:flex;justify-content:space-between;gap:12px;padding:6px 0;border-bottom:1px dashed rgba(0,0,0,0.03)}
  .meal-item small{color:#666}
  .day-header{background:#fff;padding:12px 16px;border-bottom:1px solid rgba(0,0,0,0.04);display:flex;justify-content:space-between;align-items:center}
</style>
</head>
<body>

<div class="layout">

  <!-- Sidebar (Ù…Ø«Ø§Ù„) -->
  <aside class="sidebar-sample">
    <h4>Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</h4>
    <ul class="list-unstyled mt-3">
      <li class="mb-2">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</li>
      <li class="mb-2">ğŸ§¾ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©</li>
      <li class="mb-2">ğŸ“ Ù…Ù‚Ø§Ù„Ø§Øª</li>
      <li>ğŸ“§ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</li>
    </ul>
  </aside>

  <!-- Main -->
  <main>
    <div class="app-header">
      <div class="app-logo">NF</div>
      <div>
        <h1 style="margin:0;color:#0b74de">Ø­Ø§Ø³Ø¨Ø© Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ ØªÙØµÙŠÙ„ÙŠ â€” 30 ÙŠÙˆÙ…</h1>
        <div style="color:#666;font-size:14px">Ø§Ø¯Ø®Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙˆØ³ÙŠØ¸Ù‡Ø± Ù„Ùƒ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…ÙØµÙ‘Ù„ ÙˆÙ…ØªÙ†ÙˆØ¹ Ù…Ø¹ ÙƒÙ…ÙŠØ§Øª ÙˆØ³Ø¹Ø±Ø§Øª (kcal)</div>
      </div>
    </div>

    <!-- Form -->
    <div class="card p-3 mb-3">
      <div class="row g-3">
        <div class="col-md-3">
          <label class="form-label">Ø§Ù„Ø¹Ù…Ø±</label>
          <input id="age" class="form-control" type="number" min="10" max="100" placeholder="Ù…Ø«Ù„Ø§Ù‹ 30">
        </div>
        <div class="col-md-3">
          <label class="form-label">Ø§Ù„Ø¬Ù†Ø³</label>
          <select id="gender" class="form-select">
            <option value="" selected disabled>Ø§Ø®ØªØ±</option>
            <option value="male">Ø°ÙƒØ±</option>
            <option value="female">Ø£Ù†Ø«Ù‰</option>
          </select>
        </div>
        <div class="col-md-2">
          <label class="form-label">Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)</label>
          <input id="height" class="form-control" type="number" min="100" max="230" placeholder="Ù…Ø«Ù„Ø§Ù‹ 175">
        </div>
        <div class="col-md-2">
          <label class="form-label">Ø§Ù„ÙˆØ²Ù† (ÙƒØº)</label>
          <input id="weight" class="form-control" type="number" min="30" max="250" placeholder="Ù…Ø«Ù„Ø§Ù‹ 70">
        </div>
        <div class="col-md-2">
          <label class="form-label">Ø§Ù„Ù†Ø´Ø§Ø·</label>
          <select id="activity" class="form-select">
            <option value="" selected disabled>Ø§Ø®ØªØ±</option>
            <option value="1.2">Ù‚Ù„ÙŠÙ„</option>
            <option value="1.375">Ø®ÙÙŠÙ</option>
            <option value="1.55">Ù…Ø¹ØªØ¯Ù„</option>
            <option value="1.725">ÙƒØ«ÙŠÙ</option>
            <option value="1.9">Ù†Ø´ÙŠØ· Ø¬Ø¯Ù‹Ø§</option>
          </select>
        </div>
      </div>

      <div class="row g-3 mt-2">
        <div class="col-md-4">
          <label class="form-label">Ø§Ù„Ù‡Ø¯Ù</label>
          <select id="goal" class="form-select">
            <option value="" selected disabled>Ø§Ø®ØªØ±</option>
            <option value="lose">Ù†Ù‚Øµ ÙˆØ²Ù†</option>
            <option value="maintain">Ø§Ù„Ø­ÙØ§Ø¸</option>
            <option value="gain">Ø²ÙŠØ§Ø¯Ø© ÙˆØ²Ù†</option>
          </select>
        </div>
        <div class="col-md-8 d-flex align-items-end justify-content-end">
          <button id="generateBtn" class="btn btn-primary">Ø§Ø­Ø³Ø¨ ÙˆØ§Ø·Ù„Ø¹ Ø®Ø·Ø© Ø§Ù„Ù€ 30 ÙŠÙˆÙ…</button>
        </div>
      </div>
    </div>

    <!-- Results -->
    <div id="resultsContainer" class="result-area"></div>

  </main>
</div>

<script>
// --------------------------- Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¬Ø¨Ø§Øª Ø£ÙƒØ«Ø± ØªÙ†ÙˆØ¹Ø§Ù‹ (Ù†Ù…Ø§Ø°Ø¬ Ù…ØªØ¹Ø¯Ø¯Ø© Ù„ÙƒÙ„ Ù†Ø·Ø§Ù‚ Ø³ÙØ¹Ø±ÙÙŠ)
const mealsData = {
  1200: [
    // Ù†Ù…ÙˆØ°Ø¬ A
    {
      img: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c",
      breakfast: [
        {food:"Ø¨ÙŠØ¶ Ù…Ø³Ù„ÙˆÙ‚", qty:"3 Ø¨ÙŠØ¶Ø§Øª", kcal:210},
        {food:"ØªÙˆØ³Øª Ø¨Ø±", qty:"2 Ù‚Ø·Ø¹Ø©", kcal:160},
        {food:"Ø²Ø¨Ø¯Ø© ÙÙˆÙ„ Ø³ÙˆØ¯Ø§Ù†ÙŠ", qty:"1 Ù…Ù„Ø¹Ù‚Ø© ÙƒØ¨ÙŠØ±Ø©", kcal:95},
        {food:"Ø¹ØµÙŠØ± ÙÙˆØ§ÙƒÙ‡ Ø·Ø¨ÙŠØ¹ÙŠ", qty:"1 ÙƒÙˆØ¨", kcal:80}
      ],
      preWorkout: [{food:"Ù…ÙˆØ²Ø©", qty:"1", kcal:100}],
      postWorkout: [{food:"Ø²Ø¨Ø§Ø¯ÙŠ Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø³Ù…", qty:"150 Øº", kcal:90}],
      lunch: [
        {food:"ØµØ¯Ø± Ø¯Ø¬Ø§Ø¬ Ù…Ø´ÙˆÙŠ", qty:"100 Øº", kcal:165},
        {food:"Ø£Ø±Ø² Ø¨Ù†ÙŠ", qty:"80 Øº", kcal:110},
        {food:"Ø³Ù„Ø·Ø© Ø®Ø¶Ø±Ø§Ø¡", qty:"120 Øº", kcal:40}
      ],
      dinner: [
        {food:"Ø³Ù…Ùƒ Ù…Ø´ÙˆÙŠ", qty:"120 Øº", kcal:200},
        {food:"Ø®Ø¶Ø§Ø± Ø³ÙˆØªÙŠÙ‡", qty:"120 Øº", kcal:60}
      ],
      snacks: [{food:"Ù…ÙƒØ³Ø±Ø§Øª Ù…Ø´ÙƒÙ„Ø©", qty:"20 Øº", kcal:120}]
    },
    // Ù†Ù…ÙˆØ°Ø¬ B
    {
      img: "https://images.unsplash.com/photo-1504674900247-0877df9cc836",
      breakfast:[
        {food:"Ø´ÙˆÙØ§Ù† Ù…Ø·Ø¨ÙˆØ®", qty:"1 ÙƒÙˆØ¨", kcal:150},
        {food:"Ø­Ù„ÙŠØ¨ Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø³Ù…", qty:"1 ÙƒÙˆØ¨", kcal:90},
        {food:"ØªÙØ§Ø­", qty:"1", kcal:80}
      ],
      preWorkout:[{food:"Ø¹ØµÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ ØµØºÙŠØ±", qty:"200 Ù…Ù„", kcal:90}],
      postWorkout:[{food:"ØªÙˆØ³Øª Ù…Ø¹ Ø¬Ø¨Ù†Ø© Ù‚Ø±ÙŠØ´", qty:"2 Ù‚Ø·Ø¹Ø©", kcal:160}],
      lunch:[
        {food:"Ù„Ø­Ù… Ù…ÙØ±ÙˆÙ… Ù…Ø¹ Ø®Ø¶Ø§Ø±", qty:"120 Øº", kcal:280},
        {food:"Ø¨Ø·Ø§Ø·Ø§ Ù…Ø´ÙˆÙŠØ©", qty:"100 Øº", kcal:90}
      ],
      dinner:[
        {food:"Ø­Ø³Ø§Ø¡ Ø®Ø¶Ø§Ø±", qty:"1 ÙˆØ¹Ø§Ø¡", kcal:80},
        {food:"Ø³Ù„Ø·Ø© ØªÙˆÙ†Ø©", qty:"1 Ø·Ø¨Ù‚", kcal:180}
      ],
      snacks:[{food:"Ø®ÙŠØ§Ø± ÙˆØ¬Ø²Ø± Ù…Ù‚Ø·Ø¹", qty:"150 Øº", kcal:30}]
    },
    // Ù†Ù…ÙˆØ°Ø¬ C
    {
      img: "https://images.unsplash.com/photo-1523942839745-7844a86b23c1",
      breakfast:[
        {food:"Ø¨Ø§Ù†ÙƒÙŠÙƒ Ø´ÙˆÙØ§Ù† ØµØºÙŠØ±", qty:"2 Ù‚Ø·Ø¹Ø©", kcal:220},
        {food:"Ù…ÙˆØ²", qty:"1", kcal:100}
      ],
      preWorkout:[{food:"Ø­ÙÙ†Ø© Ø²Ø¨ÙŠØ¨", qty:"30 Øº", kcal:90}],
      postWorkout:[{food:"Ø¹ØµÙŠØ± Ø¨Ø±ÙˆØªÙŠÙ† ØµØºÙŠØ±", qty:"250 Ù…Ù„", kcal:120}],
      lunch:[
        {food:"ØµØ¯Ø± Ø¯Ø¬Ø§Ø¬ Ù…Ø´ÙˆÙŠ", qty:"120 Øº", kcal:200},
        {food:"ÙƒÙŠÙ†ÙˆØ§", qty:"70 Øº", kcal:120},
        {food:"Ø®Ø¶Ø±ÙˆØ§Øª Ø³ÙˆØªÙŠÙ‡", qty:"100 Øº", kcal:50}
      ],
      dinner:[
        {food:"Ø³Ù…Ùƒ Ù…Ø·Ù‡Ùˆ Ø¨Ø§Ù„ÙØ±Ù†", qty:"120 Øº", kcal:200},
        {food:"Ø³Ù„Ø·Ø© Ø®Ø¶Ø±Ø§Ø¡", qty:"120 Øº", kcal:40}
      ],
      snacks:[{food:"Ø²Ø¨Ø§Ø¯ÙŠ Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø³Ù…", qty:"150 Øº", kcal:90}]
    }
  ],
  1800: [
    // Ù†Ù…Ø§Ø°Ø¬ Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„Ù€ 1800 (Ù…Ø«Ø§Ù„)
    {
      img:"https://images.unsplash.com/photo-1504674900247-0877df9cc836",
      breakfast:[
        {food:"4 Ø¨ÙŠØ¶Ø§Øª Ø£ÙˆÙ…Ù„ÙŠØª", qty:"4 Ø¨ÙŠØ¶Ø§Øª", kcal:320},
        {food:"ØªÙˆØ³Øª Ø¨Ø±", qty:"2 Ù‚Ø·Ø¹Ø©", kcal:160},
        {food:"Ø¹ØµÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ", qty:"1 ÙƒÙˆØ¨", kcal:100}
      ],
      preWorkout:[{food:"Ù…ÙˆØ²Ø© ÙƒØ¨ÙŠØ±Ø©", qty:"1", kcal:120}],
      postWorkout:[
        {food:"ØµØ¯Ø± Ø¯Ø¬Ø§Ø¬", qty:"180 Øº", kcal:300},
        {food:"Ø£Ø±Ø² Ø¨Ù†ÙŠ", qty:"120 Øº", kcal:150}
      ],
      lunch:[
        {food:"Ù„Ø­Ù… Ø¨Ù‚Ø±ÙŠ Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù‡Ù†", qty:"200 Øº", kcal:400},
        {food:"Ø¨Ø·Ø§Ø·Ø§", qty:"200 Øº", kcal:180},
        {food:"Ø³Ù„Ø·Ø©", qty:"150 Øº", kcal:60}
      ],
      dinner:[
        {food:"Ø³Ù„Ù…ÙˆÙ† Ù…Ø´ÙˆÙŠ", qty:"150 Øº", kcal:300},
        {food:"Ø®Ø¶Ø§Ø± Ù…Ø·Ù‡ÙˆØ©", qty:"150 Øº", kcal:80}
      ],
      snacks:[
        {food:"Ù…ÙƒØ³Ø±Ø§Øª", qty:"30 Øº", kcal:180},
        {food:"Ø²Ø¨Ø§Ø¯ÙŠ", qty:"150 Øº", kcal:90}
      ]
    },
    {
      img:"https://images.unsplash.com/photo-1541544184382-6fbf9f1526f5",
      breakfast:[
        {food:"Ø´ÙˆÙØ§Ù† + Ù„Ø¨Ù†", qty:"1 ÙƒÙˆØ¨", kcal:220},
        {food:"Ø¹Ø³Ù„", qty:"1 Ù…Ù„Ø¹Ù‚Ø©", kcal:60},
        {food:"Ù…ÙˆØ²", qty:"1", kcal:100}
      ],
      preWorkout:[{food:"ØªÙˆØ³Øª + Ø²Ø¨Ø¯Ø© ÙÙˆÙ„ Ø³ÙˆØ¯Ø§Ù†ÙŠ", qty:"1", kcal:180}],
      postWorkout:[{food:"Ø³Ù…ÙˆØ«ÙŠ Ø¨Ø±ÙˆØªÙŠÙ†", qty:"300 Ù…Ù„", kcal:220}],
      lunch:[
        {food:"ØµØ¯Ø± Ø¯Ø¬Ø§Ø¬", qty:"180 Øº", kcal:300},
        {food:"Ø£Ø±Ø²", qty:"150 Øº", kcal:200},
        {food:"Ø®Ø¶Ø§Ø±", qty:"120 Øº", kcal:50}
      ],
      dinner:[
        {food:"Ø¨Ø§Ø³ØªØ§ Ù‚Ù…Ø­ ÙƒØ§Ù…Ù„Ø©", qty:"1 ÙƒÙˆØ¨", kcal:300},
        {food:"Ø³Ù„Ø·Ø©", qty:"120 Øº", kcal:50}
      ],
      snacks:[{food:"ÙØ§ÙƒÙ‡Ø© Ù…Ø´ÙƒÙ„Ø©", qty:"150 Øº", kcal:120}]
    }
  ],
  2200: [
    {
      img:"https://images.unsplash.com/photo-1504674900247-0877df9cc836",
      breakfast:[
        {food:"5 Ø¨ÙŠØ¶Ø§Øª Ø£ÙˆÙ…Ù„ÙŠØª", qty:"5 Ø¨ÙŠØ¶Ø§Øª", kcal:400},
        {food:"ØªÙˆØ³Øª Ø¨Ø±", qty:"3 Ù‚Ø·Ø¹", kcal:240},
        {food:"Ø¹ØµÙŠØ± ÙÙˆØ§ÙƒÙ‡", qty:"1 ÙƒÙˆØ¨", kcal:120}
      ],
      preWorkout:[
        {food:"Ù…ÙˆØ²ØªÙŠÙ†", qty:"2", kcal:240}
      ],
      postWorkout:[
        {food:"ØµØ¯Ø± Ø¯Ø¬Ø§Ø¬", qty:"220 Øº", kcal:380},
        {food:"Ø£Ø±Ø² Ø¨Ù†ÙŠ", qty:"150 Øº", kcal:200}
      ],
      lunch:[
        {food:"Ù„Ø­Ù… Ø¨Ù‚Ø±ÙŠ", qty:"250 Øº", kcal:460},
        {food:"Ø¨Ø·Ø§Ø·Ø§ Ù…Ø´ÙˆÙŠØ©", qty:"250 Øº", kcal:220},
        {food:"Ø³Ù„Ø·Ø©", qty:"150 Øº", kcal:60}
      ],
      dinner:[
        {food:"Ø³Ù…Ùƒ ÙƒØ¨ÙŠØ±", qty:"220 Øº", kcal:400},
        {food:"Ø®Ø¶Ø§Ø±", qty:"200 Øº", kcal:120}
      ],
      snacks:[
        {food:"Ù…ÙƒØ³Ø±Ø§Øª", qty:"40 Øº", kcal:240},
        {food:"Ø²Ø¨Ø§Ø¯ÙŠ ÙƒØ§Ù…Ù„ Ø§Ù„Ø¯Ø³Ù…", qty:"200 Øº", kcal:160}
      ]
    }
  ],
  3000: [
    // Ø£Ù…Ø«Ù„Ø© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ù„Ù„Ù€ gain/athletes
    {
      img:"https://images.unsplash.com/photo-1546069901-ba9599a7e63c",
      breakfast:[
        {food:"6 Ø¨ÙŠØ¶Ø§Øª", qty:"6", kcal:500},
        {food:"Ø´ÙˆÙØ§Ù† Ù…Ø¹ Ø²Ø¨Ø¯Ø© Ù„ÙˆØ²", qty:"1.5 ÙƒÙˆØ¨", kcal:400}
      ],
      preWorkout:[{food:"Ø³Ù…ÙˆØ«ÙŠ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø±Ø§Øª", qty:"400 Ù…Ù„", kcal:350}],
      postWorkout:[
        {food:"ØµØ¯Ø± Ø¯Ø¬Ø§Ø¬", qty:"250 Øº", kcal:430},
        {food:"Ø£Ø±Ø²", qty:"200 Øº", kcal:260}
      ],
      lunch:[
        {food:"Ù„Ø­Ù… Ø¨Ù‚Ø±ÙŠ 300 Øº", qty:"300 Øº", kcal:550},
        {food:"Ù…Ø¹ÙƒØ±ÙˆÙ†Ø©", qty:"250 Øº", kcal:350}
      ],
      dinner:[
        {food:"Ø³Ù„Ù…ÙˆÙ† ÙƒØ¨ÙŠØ±", qty:"300 Øº", kcal:550},
        {food:"Ø®Ø¶Ø§Ø± + Ø¨Ø·Ø§Ø·Ø³", qty:"300 Øº", kcal:250}
      ],
      snacks:[
        {food:"Ù…ÙƒØ³Ø±Ø§Øª ÙƒØ¨ÙŠØ±Ø©", qty:"60 Øº", kcal:420},
        {food:"Ø²Ø¨Ø§Ø¯ÙŠ + Ø¹Ø³Ù„", qty:"250 Øº", kcal:200}
      ]
    }
  ]
};

// --------------------------- Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
function randChoice(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

// ØªÙ‚Ø±ÙŠØ¨ Ù†Ø·Ø§Ù‚ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø¥Ù„Ù‰ Ø£Ù‚Ø±Ø¨ Ù…ÙØªØ§Ø­ Ù…ØªÙˆÙØ±
function roundCalories(kcal){
  const keys = Object.keys(mealsData).map(x=>parseInt(x)).sort((a,b)=>a-b);
  let nearest = keys[0];
  let min = Math.abs(kcal - nearest);
  for(const k of keys){
    const d = Math.abs(kcal - k);
    if(d < min){ min = d; nearest = k; }
  }
  return nearest;
}

// Ø­Ø³Ø§Ø¨ BMR (Mifflin-St Jeor)
function calculateBMR(weight,height,age,gender){
  if(gender==='male') return 10*weight + 6.25*height - 5*age + 5;
  return 10*weight + 6.25*height - 5*age - 161;
}

// Ù…ÙˆÙ„Ù‘Ø¯ Ø®Ø·Ø© 30 ÙŠÙˆÙ… Ù…ØªÙ†ÙˆÙ‘Ø¹Ø©: Ù†Ø£Ø®Ø° Ù†Ù…Ø§Ø°Ø¬ Ù…ØªØ¹Ø¯Ø¯Ø© ÙˆÙ†ØºÙŠÙ‘Ø± ÙƒÙ„ ÙŠÙˆÙ…
function generatePlan(bandCalories, goal){
  const templates = mealsData[bandCalories];
  const days = [];
  for(let d=1; d<=30; d++){
    // Ù†Ø£Ø®Ø° Ù†Ù…ÙˆØ°Ø¬ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„ÙƒÙ† Ù†Ø­Ø§ÙˆÙ„ Ø§Ù„ØªÙ†ÙˆÙŠØ¹ Ø¹Ø¨Ø± Ø§Ù„Ø¯ÙˆØ±Ø§Ù†
    const template = templates[d % templates.length === 0 ? templates.length-1 : (d-1) % templates.length];
    // clone
    const copy = JSON.parse(JSON.stringify(template));
    // Ù…Ø¶Ø§Ø¹ÙØ© Ø£Ùˆ ØªØ®ÙÙŠØ¶ Ø­Ø³Ø¨ Ø§Ù„Ù‡Ø¯Ù (gain +15% , lose -10% , maintain 0%)
    let factor = 1;
    if(goal==='lose') factor = 0.90;
    else if(goal==='gain') factor = 1.15;
    // Ù†Ø·Ø¨Ù‚ Ø§Ù„Ø¹Ø§Ù…Ù„ Ø¹Ù„Ù‰ ÙƒÙ„ kcal ÙˆÙ†Ø¶ÙŠÙ Ø­Ù‚Ù„ adjusted
    ['breakfast','preWorkout','postWorkout','lunch','dinner','snacks'].forEach(section=>{
      if(!copy[section]) return;
      copy[section].forEach(it=>{
        it.adjusted = Math.round(it.kcal * factor);
      });
    });
    days.push({day:d,meal:copy});
  }
  return days;
}

// ØªØ­ÙˆÙŠÙ„ Ù„ HTML Ù…Ù†Ø³Ù‚ Ø¯Ø§Ø®Ù„ ÙƒØ±Øª Ø§Ù„ÙŠÙˆÙ…
function mealSectionHtml(title, items){
  if(!items || items.length===0) return '';
  let html = `<div class="p-2"><div class="meal-title">${title}</div>`;
  html += `<ul style="list-style:none;padding:0;margin:6px 0 8px 0">`;
  let sum=0;
  items.forEach(it=>{
    sum += it.adjusted || it.kcal;
    html += `<li class="meal-item"><div><strong>${it.qty}</strong> &nbsp; ${it.food}</div><div><small class="kcal-badge">${(it.adjusted||it.kcal)} kcal</small></div></li>`;
  });
  html += `</ul><div style="text-align:left;font-weight:700;padding-bottom:6px">Ù…Ø¬Ù…ÙˆØ¹: ${sum} Ø³Ø¹Ø±Ù‡ Ø­Ø±Ø§Ø±ÙŠØ© (${sum} kcal)</div></div>`;
  return html;
}

// render ÙƒØ§Ù…Ù„ Ø§Ù„Ø®Ø·Ø©
function renderPlan(age,gender,height,weight,activity,goal){
  const bmr = Math.round(calculateBMR(weight,height,age,gender));
  let tdee = Math.round(bmr * activity);
  if(goal==='lose') tdee = Math.round(tdee - 500);
  else if(goal==='gain') tdee = Math.round(tdee + 400);
  if(tdee < 1000) tdee = 1000;

  const band = roundCalories(tdee);
  const days = generatePlan(band, goal);

  let html = `<div class="mb-3 p-3" style="background:#fff;border-radius:12px">`;
  html += `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>Ø§Ù„Ù†ØªÙŠØ¬Ø©:</strong> BMR: ${bmr} Ø³Ø¹Ø±Ù‡ Ø­Ø±Ø§Ø±ÙŠØ© (${bmr} kcal) â€” TDEE ØªÙ‚Ø±ÙŠØ¨ÙŠ: ${tdee} Ø³Ø¹Ø±Ù‡ Ø­Ø±Ø§Ø±ÙŠØ© (${tdee} kcal) â€” BMI: ${ (weight/((height/100)**2)).toFixed(1) }</div><div style="font-size:13px;color:#666">Ù†Ø·Ø§Ù‚ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨: ${band} kcal</div></div></div>`;

  // ÙƒØ±ÙˆØª Ø§Ù„Ø£ÙŠØ§Ù… (Ù†Ø®ØªØµØ± Ø¹Ø±Ø¶ 7 Ø£ÙŠØ§Ù… ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©ØŒ ÙˆØ²Ø± Ù„ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠÙ†ØŸ Ù„ÙƒÙ† Ù‡Ù†Ø§ Ù†Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙŠØ§Ù…)
  days.forEach(d=>{
    const m = d.meal;
    html += `<div class="card-day mb-3" style="background:#fff">`;
    html += `<div class="day-header"><div>Ø§Ù„ÙŠÙˆÙ… ${d.day}</div><div style="font-size:13px;color:#666">Ù†Ø·Ø§Ù‚: ${band} kcal</div></div>`;
    if(m.img) html += `<img src="${m.img}?auto=format&fit=crop&w=1200&q=60" class="food-img" alt="food">`;
    html += `<div style="padding:12px">`;
    html += mealSectionHtml('Ø§Ù„ÙØ·ÙˆØ±', m.breakfast);
    html += mealSectionHtml('ÙˆØ¬Ø¨Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªÙ…Ø±ÙŠÙ†', m.preWorkout);
    html += mealSectionHtml('ÙˆØ¬Ø¨Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠÙ†', m.postWorkout);
    html += mealSectionHtml('Ø§Ù„ØºØ¯Ø§Ø¡', m.lunch);
    html += mealSectionHtml('Ø§Ù„Ø¹Ø´Ø§Ø¡', m.dinner);
    html += mealSectionHtml('Ø§Ù„Ø³Ù†Ø§ÙƒØ§Øª', m.snacks);
    html += `</div></div>`;
  });

  return html;
}

// Ø­Ø¯Ø« Ø§Ù„Ø²Ø±
document.getElementById('generateBtn').addEventListener('click', ()=> {
  const age = parseInt(document.getElementById('age').value);
  const gender = document.getElementById('gender').value;
  const height = parseInt(document.getElementById('height').value);
  const weight = parseInt(document.getElementById('weight').value);
  const activity = parseFloat(document.getElementById('activity').value);
  const goal = document.getElementById('goal').value;

  if(!age || !gender || !height || !weight || !activity || !goal){
    alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.');
    return;
  }

  const out = document.getElementById('resultsContainer');
  out.innerHTML = renderPlan(age,gender,height,weight,activity,goal);
  out.scrollIntoView({behavior:'smooth'});
});
</script>

</body>
</html>
