<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FIT PRO | برنامج التغذية الشامل</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --dark: #121212;
      --darker: #0D0D0D;
      --primary: #FFD700;
      --primary-dark: #FFC000;
      --secondary: #1A1A1A;
      --text: #F0F0F0;
      --text-secondary: #B0B0B0;
      --card-bg: #1A1A1A;
    }

    body {
      background-color: var(--darker);
      color: var(--text);
      font-family: 'Tajawal', sans-serif;
      overflow-x: hidden;
    }

    .content {
      padding: 40px;
      background-color: var(--dark);
      min-height: 100vh;
    }

    .header-card {
      background: linear-gradient(135deg, var(--secondary) 0%, #2A2A2A 100%);
      border-radius: 20px;
      padding: 40px;
      margin-bottom: 30px;
      border: 1px solid rgba(255, 215, 0, 0.2);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    }

    .form-card, .result-card {
      background-color: var(--card-bg);
      border-radius: 20px;
      padding: 30px;
      border: 1px solid rgba(255, 215, 0, 0.1);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }

    .btn-gold {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: #000;
      font-weight: 900;
      border: none;
      padding: 15px 30px;
      transition: all 0.4s ease-in-out;
      border-radius: 10px;
    }

    .btn-gold:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 8px 20px rgba(255, 215, 0, 0.4);
      color: #000;
    }

    .form-control, .form-select {
      background-color: #333;
      border: 1px solid #444;
      color: var(--text);
      padding: 12px 15px;
      border-radius: 8px;
    }

    .form-control:focus, .form-select:focus {
      background-color: #333;
      color: var(--text);
      border-color: var(--primary);
      box-shadow: 0 0 0 0.25rem rgba(255, 215, 0, 0.25);
    }

    .meal-card {
      background-color: #1A1A1A;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      border-left: 5px solid var(--primary);
      transition: all 0.3s ease-in-out;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    .meal-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    }

    .calorie-badge {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: #000;
      font-weight: bold;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 14px;
      min-width: 80px;
      text-align: center;
    }
    
    .day-plan {
        border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        padding-bottom: 30px;
        margin-bottom: 30px;
    }
    
    .day-plan:last-child {
        border-bottom: none;
    }

    /* Additional Customizations */
    .meal-title {
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 15px;
      font-size: 1.3rem;
    }

    .meal-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .meal-item:last-child {
      border-bottom: none;
    }

    .meal-name {
      font-weight: 500;
    }

    .drink-card {
      background-color: #222;
      border-left: 5px solid var(--primary-dark);
    }

    .goal-badge {
      padding: 5px 15px;
      border-radius: 25px;
      font-size: 13px;
      font-weight: 700;
    }

    .goal-lose {
      background-color: rgba(40, 167, 69, 0.2);
      color: #28A745;
    }

    .goal-gain {
      background-color: rgba(220, 53, 69, 0.2);
      color: #DC3545;
    }

    .goal-maintain {
      background-color: rgba(13, 110, 253, 0.2);
      color: #0D6EFD;
    }

    @media (max-width: 768px) {
      .content {
        padding: 25px;
      }
      .header-card {
        padding: 25px;
      }
      .form-card, .result-card {
        padding: 20px;
      }
      .btn-gold {
        padding: 12px 20px;
      }
    }
  </style>
</head>
<body>

<div class="content col-12">
    <div class="header-card">
      <h1 class="mb-3"><i class="fas fa-calculator" style="color: var(--primary);"></i> حاسبة اللياقة البدنية</h1>
      <p class="mb-0" style="color: var(--text-secondary);">احسب احتياجاتك اليومية من السعرات واحصل على خطة غذائية متكاملة لمدة 30 يومًا</p>
    </div>

    <div class="form-card">
      <form id="nutritionForm" novalidate>
        <div class="row">
          <div class="col-md-6 mb-4">
            <label for="age" class="form-label"><i class="fas fa-birthday-cake me-2" style="color: var(--primary);"></i>العمر (سنة):</label>
            <input type="number" id="age" class="form-control form-control-lg" min="10" max="100" placeholder="مثلاً: 30" required>
          </div>
          
          <div class="col-md-6 mb-4">
            <label for="gender" class="form-label"><i class="fas fa-venus-mars me-2" style="color: var(--primary);"></i>الجنس:</label>
            <select id="gender" class="form-select form-select-lg" required>
              <option value="" disabled selected>اختر الجنس</option>
              <option value="male">ذكر</option>
              <option value="female">أنثى</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-4">
            <label for="height" class="form-label"><i class="fas fa-text-height me-2" style="color: var(--primary);"></i>الطول (سم):</label>
            <input type="number" id="height" class="form-control form-control-lg" min="100" max="230" placeholder="مثلاً: 175" required>
          </div>
          
          <div class="col-md-6 mb-4">
            <label for="weight" class="form-label"><i class="fas fa-weight-scale me-2" style="color: var(--primary);"></i>الوزن (كغ):</label>
            <input type="number" id="weight" class="form-control form-control-lg" min="30" max="250" placeholder="مثلاً: 70" required>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-4">
            <label for="activity" class="form-label"><i class="fas fa-walking me-2" style="color: var(--primary);"></i>مستوى النشاط البدني:</label>
            <select id="activity" class="form-select form-select-lg" required>
              <option value="" disabled selected>اختر مستوى النشاط</option>
              <option value="1.2">قليل الحركة (قليل التمرين)</option>
              <option value="1.375">تمارين خفيفة 1-3 أيام في الأسبوع</option>
              <option value="1.55">تمارين معتدلة 3-5 أيام في الأسبوع</option>
              <option value="1.725">تمارين كثيفة 6-7 أيام في الأسبوع</option>
              <option value="1.9">نشاط بدني عالي جداً / عمل شاق</option>
            </select>
          </div>
          
          <div class="col-md-6 mb-4">
            <label for="goal" class="form-label"><i class="fas fa-bullseye me-2" style="color: var(--primary);"></i>هدف النظام الغذائي:</label>
            <select id="goal" class="form-select form-select-lg" required>
              <option value="" disabled selected>اختر الهدف</option>
              <option value="lose">نقص وزن (خسارة)</option>
              <option value="maintain">الحفاظ على الوزن</option>
              <option value="gain">زيادة وزن (كتلة عضلية)</option>
            </select>
          </div>
        </div>

        <div class="d-grid">
          <button type="submit" class="btn btn-gold btn-lg py-3">
            <i class="fas fa-calculator me-2"></i>احسب واطلع خطة الـ 30 يوم
          </button>
        </div>
      </form>
    </div>

    <div id="loading" class="text-center my-5" style="display:none;">
      <div class="spinner-border" style="color: var(--primary); width: 4rem; height: 4rem;" role="status">
        <span class="visually-hidden">جاري التحميل...</span>
      </div>
      <p class="mt-3" style="font-size: 1.2rem;">جاري تحليل بياناتك وإعداد خطتك الغذائية الشخصية...</p>
    </div>

    <div id="output" class="result-card mt-4" style="display:none;"></div>
  </div>
</div>

<script>
// قاعدة بيانات وجبات كبيرة ومتنوعة
const mealsDatabase = {
  breakfast: [
    { food: "شوفان مع حليب خالي الدسم", qty: "40 جرام", kcal: 180, protein: 8, carbs: 30, fat: 3 },
    { food: "عجة بيض", qty: "2 بيضات", kcal: 140, protein: 12, carbs: 1, fat: 10 },
    { food: "زبادي يوناني مع توت", qty: "150 جرام", kcal: 150, protein: 15, carbs: 15, fat: 3 },
    { food: "خبز توست أسمر مع جبنة قريش", qty: "2 شريحة", kcal: 200, protein: 18, carbs: 20, fat: 5 },
    { food: "أومليت بالخضار", qty: "3 بيضات", kcal: 220, protein: 18, carbs: 5, fat: 15 },
    { food: "فول مدمس", qty: "100 جرام", kcal: 170, protein: 10, carbs: 25, fat: 4 },
    { food: "سندويش جبن أبيض وخيار", qty: "1 حبة", kcal: 190, protein: 10, carbs: 25, fat: 5 },
    { food: "بان كيك الشوفان", qty: "2 حبة", kcal: 250, protein: 10, carbs: 30, fat: 8 }
  ],
  lunch: [
    { food: "صدر دجاج مشوي", qty: "150 جرام", kcal: 220, protein: 35, carbs: 0, fat: 5 },
    { food: "سمك مشوي", qty: "150 جرام", kcal: 210, protein: 30, carbs: 0, fat: 9 },
    { food: "سلطة كينوا مع خضار", qty: "طبق", kcal: 350, protein: 12, carbs: 50, fat: 12 },
    { food: "لحم بقري مشوي", qty: "120 جرام", kcal: 250, protein: 30, carbs: 0, fat: 14 },
    { food: "عدس مطبوخ", qty: "150 جرام", kcal: 230, protein: 18, carbs: 35, fat: 2 },
    { food: "ساندويتش دجاج مشوي", qty: "1 حبة", kcal: 300, protein: 25, carbs: 30, fat: 10 },
    { food: "مكرونة قمح كامل", qty: "150 جرام", kcal: 280, protein: 10, carbs: 50, fat: 5 }
  ],
  dinner: [
    { food: "صدر دجاج مشوي مع خضار", qty: "120 جرام", kcal: 180, protein: 28, carbs: 5, fat: 5 },
    { food: "شوربة خضار", qty: "طبق كبير", kcal: 120, protein: 5, carbs: 20, fat: 2 },
    { food: "سمك فيليه", qty: "100 جرام", kcal: 160, protein: 24, carbs: 0, fat: 7 },
    { food: "زبادي مع فواكه", qty: "كوب", kcal: 180, protein: 10, carbs: 25, fat: 4 },
    { food: "سلطة تونا", qty: "طبق", kcal: 220, protein: 25, carbs: 5, fat: 10 },
    { food: "جبن أبيض وبيض مسلوق", qty: "100 جرام", kcal: 200, protein: 15, carbs: 5, fat: 12 }
  ],
  snack: [
    { food: "موزة صغيرة", qty: "1 حبة", kcal: 90, protein: 1, carbs: 23, fat: 0 },
    { food: "تفاح", qty: "1 حبة متوسطة", kcal: 95, protein: 0, carbs: 25, fat: 0 },
    { food: "لوز", qty: "10 حبات", kcal: 70, protein: 3, carbs: 2, fat: 6 },
    { food: "جزر", qty: "2 حبة متوسطة", kcal: 50, protein: 1, carbs: 12, fat: 0 },
    { food: "حمص", qty: "30 جرام", kcal: 50, protein: 3, carbs: 6, fat: 2 },
    { food: "جبنة قريش", qty: "50 جرام", kcal: 50, protein: 11, carbs: 2, fat: 1 },
    { food: "كوب حليب خالي الدسم", qty: "1 كوب", kcal: 90, protein: 8, carbs: 12, fat: 0 },
    { food: "برتقال", qty: "1 حبة", kcal: 60, protein: 1, carbs: 15, fat: 0 },
    { food: "كوب زبادي", qty: "1 كوب", kcal: 100, protein: 6, carbs: 15, fat: 2 }
  ],
  drink: [
    { food: "شاي أخضر", qty: "كوب", kcal: 0, protein: 0, carbs: 0, fat: 0 },
    { food: "قهوة سوداء", qty: "كوب", kcal: 5, protein: 0, carbs: 0, fat: 0 },
    { food: "ماء", qty: "2 لتر", kcal: 0, protein: 0, carbs: 0, fat: 0 }
  ]
};

// حساب معدل الأيض الأساسي (BMR)
function calculateBMR(weight, height, age, gender) {
  if (gender === 'male') {
    return (10 * weight) + (6.25 * height) - (5 * age) + 5;
  } else {
    return (10 * weight) + (6.25 * height) - (5 * age) - 161;
  }
}

// حساب مؤشر كتلة الجسم وتصنيفه
function calculateBMI(weight, height) {
  const bmiValue = (weight / Math.pow(height / 100, 2)).toFixed(1);
  let bmiCategory = "";
  
  if (bmiValue < 18.5) bmiCategory = "نقص في الوزن";
  else if (bmiValue < 24.9) bmiCategory = "وزن طبيعي";
  else if (bmiValue < 29.9) bmiCategory = "زيادة في الوزن";
  else if (bmiValue < 34.9) bmiCategory = "سمنة من الدرجة الأولى";
  else if (bmiValue < 39.9) bmiCategory = "سمنة من الدرجة الثانية";
  else bmiCategory = "سمنة مفرطة";
  
  return { value: bmiValue, category: bmiCategory };
}

// توليد خطة غذائية عشوائية لليوم الواحد
function generateDailyPlan(targetCalories) {
  const dailyPlan = { breakfast: [], snack1: [], lunch: [], snack2: [], dinner: [], drink: [] };
  
  const mealRatios = {
    breakfast: 0.25,
    snack1: 0.05,
    lunch: 0.35,
    snack2: 0.05,
    dinner: 0.30
  };

  for (const mealType in mealRatios) {
    const targetMealCalories = targetCalories * mealRatios[mealType];
    const mealsList = mealType.includes('snack') ? mealsDatabase.snack : mealsDatabase[mealType];
    const suitableMeals = mealsList.filter(meal => meal.kcal <= targetMealCalories);

    if (suitableMeals.length > 0) {
      dailyPlan[mealType].push(suitableMeals[Math.floor(Math.random() * suitableMeals.length)]);
    } else if (mealsList.length > 0) {
      dailyPlan[mealType].push(mealsList[Math.floor(Math.random() * mealsList.length)]);
    }
  }

  dailyPlan.drink.push(...mealsDatabase.drink);
  
  return dailyPlan;
}

// عرض الخطة كاملة
function renderPlan(age, gender, height, weight, activity, goal) {
  const bmr = calculateBMR(weight, height, age, gender);
  let tdee = Math.round(bmr * activity);
  
  if (goal === "lose") tdee = Math.round(tdee - 500);
  else if (goal === "gain") tdee = Math.round(tdee + 500);
  
  if (tdee < 1200) tdee = 1200;
  
  const bmi = calculateBMI(weight, height);
  
  let html = `<div class="mb-5">
                <h3 class="mb-4" style="color: var(--primary);"><i class="fas fa-chart-pie me-2"></i>النتائج الشخصية</h3>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <div class="p-4" style="background-color: var(--secondary); border-radius: 15px;">
                      <h5><i class="fas fa-user me-2"></i>البيانات الشخصية</h5>
                      <p class="mb-1"><strong>العمر:</strong> ${age} سنة</p>
                      <p class="mb-1"><strong>الجنس:</strong> ${gender === "male" ? "ذكر" : "أنثى"}</p>
                      <p class="mb-1"><strong>الطول:</strong> ${height} سم</p>
                      <p class="mb-1"><strong>الوزن:</strong> ${weight} كغ</p>
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="p-4" style="background-color: var(--secondary); border-radius: 15px;">
                      <h5><i class="fas fa-chart-line me-2"></i>المؤشرات الصحية</h5>
                      <p class="mb-1"><strong>مؤشر كتلة الجسم (BMI):</strong> ${bmi.value} (${bmi.category})</p>
                      <p class="mb-1"><strong>معدل الأيض الأساسي (BMR):</strong> ${Math.round(bmr)} سعرة/يوم</p>
                      <p class="mb-1"><strong>إجمالي السعرات اليومية (TDEE):</strong> ${tdee} سعرة/يوم</p>
                      <p class="mb-0"><strong>النظام الموصى به:</strong> ${tdee} سعرة/يوم</p>
                    </div>
                  </div>
                </div>
              </div>`;
  
  html += `<h3 class="mb-4" style="color: var(--primary);"><i class="fas fa-calendar-alt me-2"></i>الخطة الغذائية لمدة 30 يوم</h3>
           <div class="alert alert-dark" style="background-color: var(--secondary); border: none;">
             <i class="fas fa-info-circle me-2" style="color: var(--primary);"></i>
             نظامك الغذائي اليومي يحتوي على ${tdee} سعرة حرارية مع توزيع مثالي للمغذيات الكبرى
           </div>`;
  
  for (let i = 1; i <= 30; i++) {
    const dayPlan = generateDailyPlan(tdee);
    html += `<div class="day-plan">
              <h4 class="mb-4 d-flex justify-content-between align-items-center">
                <span><i class="fas fa-calendar-day me-2"></i>اليوم ${i}</span>
                <span class="goal-badge ${goal === 'lose' ? 'goal-lose' : goal === 'gain' ? 'goal-gain' : 'goal-maintain'}">
                  ${goal === 'lose' ? 'خسارة وزن' : goal === 'gain' ? 'زيادة وزن' : 'حفاظ'}
                </span>
              </h4>
              
              ${formatMealHtml("breakfast", dayPlan.breakfast)}
              ${dayPlan.snack1.length > 0 ? formatMealHtml("snack1", dayPlan.snack1) : ''}
              ${formatMealHtml("lunch", dayPlan.lunch)}
              ${dayPlan.snack2.length > 0 ? formatMealHtml("snack2", dayPlan.snack2) : ''}
              ${formatMealHtml("dinner", dayPlan.dinner)}
              ${dayPlan.drink.length > 0 ? formatMealHtml("drink", dayPlan.drink) : ''}
            </div>`;
  }
  
  html += `<div class="mt-5 text-center">
            <button class="btn btn-gold me-3"><i class="fas fa-file-pdf me-2"></i>حفظ الخطة كـ PDF</button>
            <button class="btn btn-outline-light"><i class="fas fa-envelope me-2"></i>إرسال إلى بريدي</button>
          </div>`;
  
  return html;
}

// تنسيق الوجبات للعرض
function formatMealHtml(mealName, items) {
  if (items.length === 0) return '';
  let totalCalories = 0;
  let totalProtein = 0;
  let totalCarbs = 0;
  let totalFat = 0;
  
  let html = `<div class="meal-card ${mealName === 'drink' ? 'drink-card' : ''}">
                <h5 class="meal-title"><i class="fas fa-${mealName === 'breakfast' ? 'sun' : mealName === 'lunch' ? 'utensils' : mealName === 'dinner' ? 'moon' : mealName.includes('snack') ? 'apple-alt' : 'glass-whiskey'} me-2"></i>${mealName === 'snack1' ? 'وجبة خفيفة 1' : mealName === 'snack2' ? 'وجبة خفيفة 2' : mealName === 'drink' ? 'المشروبات' : mealName}</h5>
                <div class="meal-items">`;
  
  items.forEach(item => {
    totalCalories += item.kcal;
    totalProtein += item.protein || 0;
    totalCarbs += item.carbs || 0;
    totalFat += item.fat || 0;
    
    html += `<div class="meal-item">
              <span class="meal-name">${item.qty} ${item.food}</span>
              <span class="calorie-badge">${item.kcal} kcal</span>
            </div>`;
  });
  
  html += `</div>
           <div class="mt-3" style="font-size: 0.9rem; color: var(--text-secondary);">
             <span class="me-3"><i class="fas fa-fire me-1"></i> ${totalCalories} سعرة</span>
             <span class="me-3"><i class="fas fa-dumbbell me-1"></i> ${totalProtein}g بروتين</span>
             <span class="me-3"><i class="fas fa-bread-slice me-1"></i> ${totalCarbs}g كارب</span>
             <span><i class="fas fa-oil-can me-1"></i> ${totalFat}g دهون</span>
           </div>
           </div>`;
  
  return html;
}

// إدارة عملية الإرسال
document.getElementById("nutritionForm").addEventListener("submit", function(e) {
  e.preventDefault();
  
  const form = e.target;
  if (!form.checkValidity()) {
    form.reportValidity();
    return;
  }
  
  const loading = document.getElementById("loading");
  const output = document.getElementById("output");
  loading.style.display = "block";
  output.style.display = "none";
  
  const age = parseInt(document.getElementById("age").value);
  const gender = document.getElementById("gender").value;
  const height = parseInt(document.getElementById("height").value);
  const weight = parseInt(document.getElementById("weight").value);
  const activity = parseFloat(document.getElementById("activity").value);
  const goal = document.getElementById("goal").value;
  
  setTimeout(() => {
    try {
      const planHtml = renderPlan(age, gender, height, weight, activity, goal);
      output.style.display = "block";
      output.innerHTML = planHtml;
      loading.style.display = "none";
      
      window.scrollTo({
        top: output.offsetTop - 20,
        behavior: "smooth"
      });
      
    } catch (error) {
      console.error("حدث خطأ:", error);
      loading.style.display = "none";
      output.innerHTML = `<div class="alert alert-danger">حدث خطأ أثناء معالجة طلبك. يرجى المحاولة مرة أخرى.</div>`;
      output.style.display = "block";
    }
  }, 1500);
});
</script>

</body>
</html>
