<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>حاسبة نظام غذائي تفصيلي 30 يوم</title>
<!-- Bootstrap RTL (CDN) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet" />
<style>
  body{
    background:#f4f7fb;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    color:#222;
    padding:18px;
  }
  .card-day{
    border-radius:12px;
    box-shadow:0 6px 24px rgba(11,116,222,0.08);
    overflow:hidden;
    margin-bottom:18px;
  }
  .meal-title{font-weight:700;color:#0b74de}
  .kcal-badge{font-weight:700;color:#0b74de}
  .sidebar-sample{background:#0b74de;color:#fff;padding:18px;border-radius:12px;height:100%}
  .app-header{display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:18px}
  .app-logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#0b74de,#2db7f5);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900;font-size:20px}
  /* responsive grid */
  @media(min-width:1000px){
    .layout {display:grid;grid-template-columns:280px 1fr;gap:22px;}
  }
  .result-area{max-height:620px;overflow:auto;padding:0 8px;}
  .food-img{width:100%;height:120px;object-fit:cover;border-bottom:1px solid rgba(0,0,0,0.06)}
  .meal-item{display:flex;justify-content:space-between;gap:12px;padding:6px 0;border-bottom:1px dashed rgba(0,0,0,0.03)}
  .meal-item small{color:#666}
  .day-header{background:#fff;padding:12px 16px;border-bottom:1px solid rgba(0,0,0,0.04);display:flex;justify-content:space-between;align-items:center}
</style>
</head>
<body>

<div class="layout">

  <!-- Sidebar (مثال) -->
  <aside class="sidebar-sample">
    <h4>القائمة</h4>
    <ul class="list-unstyled mt-3">
      <li class="mb-2">🏠 الرئيسية</li>
      <li class="mb-2">🧾 الحاسبة</li>
      <li class="mb-2">📝 مقالات</li>
      <li>📧 تواصل معنا</li>
    </ul>
  </aside>

  <!-- Main -->
  <main>
    <div class="app-header">
      <div class="app-logo">NF</div>
      <div>
        <h1 style="margin:0;color:#0b74de">حاسبة نظام غذائي تفصيلي — 30 يوم</h1>
        <div style="color:#666;font-size:14px">ادخل معلوماتك وسيظهر لك برنامج مفصّل ومتنوع مع كميات وسعرات (kcal)</div>
      </div>
    </div>

    <!-- Form -->
    <div class="card p-3 mb-3">
      <div class="row g-3">
        <div class="col-md-3">
          <label class="form-label">العمر</label>
          <input id="age" class="form-control" type="number" min="10" max="100" placeholder="مثلاً 30">
        </div>
        <div class="col-md-3">
          <label class="form-label">الجنس</label>
          <select id="gender" class="form-select">
            <option value="" selected disabled>اختر</option>
            <option value="male">ذكر</option>
            <option value="female">أنثى</option>
          </select>
        </div>
        <div class="col-md-2">
          <label class="form-label">الطول (سم)</label>
          <input id="height" class="form-control" type="number" min="100" max="230" placeholder="مثلاً 175">
        </div>
        <div class="col-md-2">
          <label class="form-label">الوزن (كغ)</label>
          <input id="weight" class="form-control" type="number" min="30" max="250" placeholder="مثلاً 70">
        </div>
        <div class="col-md-2">
          <label class="form-label">النشاط</label>
          <select id="activity" class="form-select">
            <option value="" selected disabled>اختر</option>
            <option value="1.2">قليل</option>
            <option value="1.375">خفيف</option>
            <option value="1.55">معتدل</option>
            <option value="1.725">كثيف</option>
            <option value="1.9">نشيط جدًا</option>
          </select>
        </div>
      </div>

      <div class="row g-3 mt-2">
        <div class="col-md-4">
          <label class="form-label">الهدف</label>
          <select id="goal" class="form-select">
            <option value="" selected disabled>اختر</option>
            <option value="lose">نقص وزن</option>
            <option value="maintain">الحفاظ</option>
            <option value="gain">زيادة وزن</option>
          </select>
        </div>
        <div class="col-md-8 d-flex align-items-end justify-content-end">
          <button id="generateBtn" class="btn btn-primary">احسب واطلع خطة الـ 30 يوم</button>
        </div>
      </div>
    </div>

    <!-- Results -->
    <div id="resultsContainer" class="result-area"></div>

  </main>
</div>

<script>
// --------------------------- بيانات وجبات أكثر تنوعاً (نماذج متعددة لكل نطاق سَعرِي)
const mealsData = {
  1200: [
    // نموذج A
    {
      img: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c",
      breakfast: [
        {food:"بيض مسلوق", qty:"3 بيضات", kcal:210},
        {food:"توست بر", qty:"2 قطعة", kcal:160},
        {food:"زبدة فول سوداني", qty:"1 ملعقة كبيرة", kcal:95},
        {food:"عصير فواكه طبيعي", qty:"1 كوب", kcal:80}
      ],
      preWorkout: [{food:"موزة", qty:"1", kcal:100}],
      postWorkout: [{food:"زبادي قليل الدسم", qty:"150 غ", kcal:90}],
      lunch: [
        {food:"صدر دجاج مشوي", qty:"100 غ", kcal:165},
        {food:"أرز بني", qty:"80 غ", kcal:110},
        {food:"سلطة خضراء", qty:"120 غ", kcal:40}
      ],
      dinner: [
        {food:"سمك مشوي", qty:"120 غ", kcal:200},
        {food:"خضار سوتيه", qty:"120 غ", kcal:60}
      ],
      snacks: [{food:"مكسرات مشكلة", qty:"20 غ", kcal:120}]
    },
    // نموذج B
    {
      img: "https://images.unsplash.com/photo-1504674900247-0877df9cc836",
      breakfast:[
        {food:"شوفان مطبوخ", qty:"1 كوب", kcal:150},
        {food:"حليب قليل الدسم", qty:"1 كوب", kcal:90},
        {food:"تفاح", qty:"1", kcal:80}
      ],
      preWorkout:[{food:"عصير طبيعي صغير", qty:"200 مل", kcal:90}],
      postWorkout:[{food:"توست مع جبنة قريش", qty:"2 قطعة", kcal:160}],
      lunch:[
        {food:"لحم مفروم مع خضار", qty:"120 غ", kcal:280},
        {food:"بطاطا مشوية", qty:"100 غ", kcal:90}
      ],
      dinner:[
        {food:"حساء خضار", qty:"1 وعاء", kcal:80},
        {food:"سلطة تونة", qty:"1 طبق", kcal:180}
      ],
      snacks:[{food:"خيار وجزر مقطع", qty:"150 غ", kcal:30}]
    },
    // نموذج C
    {
      img: "https://images.unsplash.com/photo-1523942839745-7844a86b23c1",
      breakfast:[
        {food:"بانكيك شوفان صغير", qty:"2 قطعة", kcal:220},
        {food:"موز", qty:"1", kcal:100}
      ],
      preWorkout:[{food:"حفنة زبيب", qty:"30 غ", kcal:90}],
      postWorkout:[{food:"عصير بروتين صغير", qty:"250 مل", kcal:120}],
      lunch:[
        {food:"صدر دجاج مشوي", qty:"120 غ", kcal:200},
        {food:"كينوا", qty:"70 غ", kcal:120},
        {food:"خضروات سوتيه", qty:"100 غ", kcal:50}
      ],
      dinner:[
        {food:"سمك مطهو بالفرن", qty:"120 غ", kcal:200},
        {food:"سلطة خضراء", qty:"120 غ", kcal:40}
      ],
      snacks:[{food:"زبادي قليل الدسم", qty:"150 غ", kcal:90}]
    }
  ],
  1800: [
    // نماذج متعددة للـ 1800 (مثال)
    {
      img:"https://images.unsplash.com/photo-1504674900247-0877df9cc836",
      breakfast:[
        {food:"4 بيضات أومليت", qty:"4 بيضات", kcal:320},
        {food:"توست بر", qty:"2 قطعة", kcal:160},
        {food:"عصير طبيعي", qty:"1 كوب", kcal:100}
      ],
      preWorkout:[{food:"موزة كبيرة", qty:"1", kcal:120}],
      postWorkout:[
        {food:"صدر دجاج", qty:"180 غ", kcal:300},
        {food:"أرز بني", qty:"120 غ", kcal:150}
      ],
      lunch:[
        {food:"لحم بقري قليل الدهن", qty:"200 غ", kcal:400},
        {food:"بطاطا", qty:"200 غ", kcal:180},
        {food:"سلطة", qty:"150 غ", kcal:60}
      ],
      dinner:[
        {food:"سلمون مشوي", qty:"150 غ", kcal:300},
        {food:"خضار مطهوة", qty:"150 غ", kcal:80}
      ],
      snacks:[
        {food:"مكسرات", qty:"30 غ", kcal:180},
        {food:"زبادي", qty:"150 غ", kcal:90}
      ]
    },
    {
      img:"https://images.unsplash.com/photo-1541544184382-6fbf9f1526f5",
      breakfast:[
        {food:"شوفان + لبن", qty:"1 كوب", kcal:220},
        {food:"عسل", qty:"1 ملعقة", kcal:60},
        {food:"موز", qty:"1", kcal:100}
      ],
      preWorkout:[{food:"توست + زبدة فول سوداني", qty:"1", kcal:180}],
      postWorkout:[{food:"سموثي بروتين", qty:"300 مل", kcal:220}],
      lunch:[
        {food:"صدر دجاج", qty:"180 غ", kcal:300},
        {food:"أرز", qty:"150 غ", kcal:200},
        {food:"خضار", qty:"120 غ", kcal:50}
      ],
      dinner:[
        {food:"باستا قمح كاملة", qty:"1 كوب", kcal:300},
        {food:"سلطة", qty:"120 غ", kcal:50}
      ],
      snacks:[{food:"فاكهة مشكلة", qty:"150 غ", kcal:120}]
    }
  ],
  2200: [
    {
      img:"https://images.unsplash.com/photo-1504674900247-0877df9cc836",
      breakfast:[
        {food:"5 بيضات أومليت", qty:"5 بيضات", kcal:400},
        {food:"توست بر", qty:"3 قطع", kcal:240},
        {food:"عصير فواكه", qty:"1 كوب", kcal:120}
      ],
      preWorkout:[
        {food:"موزتين", qty:"2", kcal:240}
      ],
      postWorkout:[
        {food:"صدر دجاج", qty:"220 غ", kcal:380},
        {food:"أرز بني", qty:"150 غ", kcal:200}
      ],
      lunch:[
        {food:"لحم بقري", qty:"250 غ", kcal:460},
        {food:"بطاطا مشوية", qty:"250 غ", kcal:220},
        {food:"سلطة", qty:"150 غ", kcal:60}
      ],
      dinner:[
        {food:"سمك كبير", qty:"220 غ", kcal:400},
        {food:"خضار", qty:"200 غ", kcal:120}
      ],
      snacks:[
        {food:"مكسرات", qty:"40 غ", kcal:240},
        {food:"زبادي كامل الدسم", qty:"200 غ", kcal:160}
      ]
    }
  ],
  3000: [
    // أمثلة عالية السعرات للـ gain/athletes
    {
      img:"https://images.unsplash.com/photo-1546069901-ba9599a7e63c",
      breakfast:[
        {food:"6 بيضات", qty:"6", kcal:500},
        {food:"شوفان مع زبدة لوز", qty:"1.5 كوب", kcal:400}
      ],
      preWorkout:[{food:"سموثي عالي السعرات", qty:"400 مل", kcal:350}],
      postWorkout:[
        {food:"صدر دجاج", qty:"250 غ", kcal:430},
        {food:"أرز", qty:"200 غ", kcal:260}
      ],
      lunch:[
        {food:"لحم بقري 300 غ", qty:"300 غ", kcal:550},
        {food:"معكرونة", qty:"250 غ", kcal:350}
      ],
      dinner:[
        {food:"سلمون كبير", qty:"300 غ", kcal:550},
        {food:"خضار + بطاطس", qty:"300 غ", kcal:250}
      ],
      snacks:[
        {food:"مكسرات كبيرة", qty:"60 غ", kcal:420},
        {food:"زبادي + عسل", qty:"250 غ", kcal:200}
      ]
    }
  ]
};

// --------------------------- دوال مساعدة
function randChoice(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

// تقريب نطاق السعرات إلى أقرب مفتاح متوفر
function roundCalories(kcal){
  const keys = Object.keys(mealsData).map(x=>parseInt(x)).sort((a,b)=>a-b);
  let nearest = keys[0];
  let min = Math.abs(kcal - nearest);
  for(const k of keys){
    const d = Math.abs(kcal - k);
    if(d < min){ min = d; nearest = k; }
  }
  return nearest;
}

// حساب BMR (Mifflin-St Jeor)
function calculateBMR(weight,height,age,gender){
  if(gender==='male') return 10*weight + 6.25*height - 5*age + 5;
  return 10*weight + 6.25*height - 5*age - 161;
}

// مولّد خطة 30 يوم متنوّعة: نأخذ نماذج متعددة ونغيّر كل يوم
function generatePlan(bandCalories, goal){
  const templates = mealsData[bandCalories];
  const days = [];
  for(let d=1; d<=30; d++){
    // نأخذ نموذج عشوائي لكن نحاول التنويع عبر الدوران
    const template = templates[d % templates.length === 0 ? templates.length-1 : (d-1) % templates.length];
    // clone
    const copy = JSON.parse(JSON.stringify(template));
    // مضاعفة أو تخفيض حسب الهدف (gain +15% , lose -10% , maintain 0%)
    let factor = 1;
    if(goal==='lose') factor = 0.90;
    else if(goal==='gain') factor = 1.15;
    // نطبق العامل على كل kcal ونضيف حقل adjusted
    ['breakfast','preWorkout','postWorkout','lunch','dinner','snacks'].forEach(section=>{
      if(!copy[section]) return;
      copy[section].forEach(it=>{
        it.adjusted = Math.round(it.kcal * factor);
      });
    });
    days.push({day:d,meal:copy});
  }
  return days;
}

// تحويل ل HTML منسق داخل كرت اليوم
function mealSectionHtml(title, items){
  if(!items || items.length===0) return '';
  let html = `<div class="p-2"><div class="meal-title">${title}</div>`;
  html += `<ul style="list-style:none;padding:0;margin:6px 0 8px 0">`;
  let sum=0;
  items.forEach(it=>{
    sum += it.adjusted || it.kcal;
    html += `<li class="meal-item"><div><strong>${it.qty}</strong> &nbsp; ${it.food}</div><div><small class="kcal-badge">${(it.adjusted||it.kcal)} kcal</small></div></li>`;
  });
  html += `</ul><div style="text-align:left;font-weight:700;padding-bottom:6px">مجموع: ${sum} سعره حرارية (${sum} kcal)</div></div>`;
  return html;
}

// render كامل الخطة
function renderPlan(age,gender,height,weight,activity,goal){
  const bmr = Math.round(calculateBMR(weight,height,age,gender));
  let tdee = Math.round(bmr * activity);
  if(goal==='lose') tdee = Math.round(tdee - 500);
  else if(goal==='gain') tdee = Math.round(tdee + 400);
  if(tdee < 1000) tdee = 1000;

  const band = roundCalories(tdee);
  const days = generatePlan(band, goal);

  let html = `<div class="mb-3 p-3" style="background:#fff;border-radius:12px">`;
  html += `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>النتيجة:</strong> BMR: ${bmr} سعره حرارية (${bmr} kcal) — TDEE تقريبي: ${tdee} سعره حرارية (${tdee} kcal) — BMI: ${ (weight/((height/100)**2)).toFixed(1) }</div><div style="font-size:13px;color:#666">نطاق القوالب: ${band} kcal</div></div></div>`;

  // كروت الأيام (نختصر عرض 7 أيام في الواجهة، وزر لتحميل كل الثلاثين؟ لكن هنا نعرض جميع الأيام)
  days.forEach(d=>{
    const m = d.meal;
    html += `<div class="card-day mb-3" style="background:#fff">`;
    html += `<div class="day-header"><div>اليوم ${d.day}</div><div style="font-size:13px;color:#666">نطاق: ${band} kcal</div></div>`;
    if(m.img) html += `<img src="${m.img}?auto=format&fit=crop&w=1200&q=60" class="food-img" alt="food">`;
    html += `<div style="padding:12px">`;
    html += mealSectionHtml('الفطور', m.breakfast);
    html += mealSectionHtml('وجبة قبل التمرين', m.preWorkout);
    html += mealSectionHtml('وجبة بعد التمرين', m.postWorkout);
    html += mealSectionHtml('الغداء', m.lunch);
    html += mealSectionHtml('العشاء', m.dinner);
    html += mealSectionHtml('السناكات', m.snacks);
    html += `</div></div>`;
  });

  return html;
}

// حدث الزر
document.getElementById('generateBtn').addEventListener('click', ()=> {
  const age = parseInt(document.getElementById('age').value);
  const gender = document.getElementById('gender').value;
  const height = parseInt(document.getElementById('height').value);
  const weight = parseInt(document.getElementById('weight').value);
  const activity = parseFloat(document.getElementById('activity').value);
  const goal = document.getElementById('goal').value;

  if(!age || !gender || !height || !weight || !activity || !goal){
    alert('يرجى تعبئة جميع الحقول بشكل صحيح.');
    return;
  }

  const out = document.getElementById('resultsContainer');
  out.innerHTML = renderPlan(age,gender,height,weight,activity,goal);
  out.scrollIntoView({behavior:'smooth'});
});
</script>

</body>
</html>
