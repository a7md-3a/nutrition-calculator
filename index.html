<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>حاسبة نظام غذائي تفصيلي 30 يوم</title>
<style>
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    direction: rtl;
    background: #f9f9f9;
    color: #222;
    padding: 20px;
    line-height: 1.6;
  }
  h1 {
    text-align: center;
    color: #0b74de;
    margin-bottom: 15px;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: 700;
  }
  input, select {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    margin-top: 5px;
    border-radius: 8px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
  button {
    margin-top: 25px;
    padding: 12px 18px;
    width: 100%;
    font-size: 18px;
    background-color: #0b74de;
    border: none;
    border-radius: 10px;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  button:hover {
    background-color: #094d99;
  }
  .result {
    white-space: pre-wrap;
    background: white;
    padding: 25px;
    border-radius: 12px;
    margin-top: 35px;
    max-height: 600px;
    overflow-y: auto;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    font-size: 15px;
  }
  .small {
    font-size: 13px;
    color: #555;
    text-align: center;
    margin-top: 14px;
  }
</style>
</head>
<body>

<h1>حاسبة نظام غذائي تفصيلي لمدة 30 يوم</h1>

<label for="age">العمر (سنة):</label>
<input type="number" id="age" min="10" max="100" placeholder="مثلاً: 30" />

<label for="gender">الجنس:</label>
<select id="gender">
  <option value="" disabled selected>اختر الجنس</option>
  <option value="male">ذكر</option>
  <option value="female">أنثى</option>
</select>

<label for="height">الطول (سم):</label>
<input type="number" id="height" min="100" max="230" placeholder="مثلاً: 175" />

<label for="weight">الوزن (كغ):</label>
<input type="number" id="weight" min="30" max="250" placeholder="مثلاً: 70" />

<label for="activity">مستوى النشاط البدني:</label>
<select id="activity">
  <option value="" disabled selected>اختر مستوى النشاط</option>
  <option value="1.2">قليل الحركة (قليل التمرين)</option>
  <option value="1.375">تمارين خفيفة 1-3 أيام في الأسبوع</option>
  <option value="1.55">تمارين معتدلة 3-5 أيام في الأسبوع</option>
  <option value="1.725">تمارين كثيفة 6-7 أيام في الأسبوع</option>
  <option value="1.9">نشاط بدني عالي جداً / عمل شاق</option>
</select>

<label for="goal">هدف النظام الغذائي:</label>
<select id="goal">
  <option value="" disabled selected>اختر الهدف</option>
  <option value="lose">نقص وزن (خسارة)</option>
  <option value="maintain">الحفاظ على الوزن</option>
  <option value="gain">زيادة وزن (كتلة عضلية)</option>
</select>

<button id="generateBtn">احسب واطلع خطة الـ 30 يوم</button>

<div id="output" class="result" style="display:none;"></div>

<div class="small">النتائج تقديرية فقط، يرجى استشارة أخصائي تغذية لأي حالة خاصة.</div>

<script>
const mealsData = {
  1200: [
    {
      breakfast: [
        { food: "بيض مسلوق", qty: "3 بيضات", kcal: 210 },
        { food: "توست بر", qty: "2 قطعة", kcal: 160 },
        { food: "زبدة فول سوداني", qty: "1.5 ملعقة كبيرة", kcal: 140 },
        { food: "كوب عصير فواكه طبيعي", qty: "1 كوب", kcal: 100 },
      ],
      preWorkout: [
        { food: "موزة", qty: "1 متوسطة", kcal: 100 },
        { food: "زبادي قليل الدسم", qty: "100 غ", kcal: 60 },
      ],
      postWorkout: [
        { food: "صدر دجاج مشوي", qty: "100 غ", kcal: 165 },
        { food: "أرز بني", qty: "80 غ", kcal: 110 },
      ],
      lunch: [
        { food: "لحم بقري قليل الدهن", qty: "120 غ", kcal: 250 },
        { food: "بطاطا مشوية", qty: "150 غ", kcal: 130 },
        { food: "سلطة خضراء", qty: "100 غ", kcal: 40 },
      ],
      dinner: [
        { food: "سمك مشوي", qty: "120 غ", kcal: 200 },
        { food: "خضار مطهوة", qty: "150 غ", kcal: 80 },
        { food: "تفاحة", qty: "1", kcal: 80 },
      ],
      snacks: [
        { food: "مكسرات مشكلة", qty: "20 غ", kcal: 120 },
      ],
    },
  ],
  1500: [
    {
      breakfast: [
        { food: "4 بيضات مسلوقة", qty: "4 بيضات", kcal: 280 },
        { food: "توست بر", qty: "2 قطعة", kcal: 160 },
        { food: "زبدة فول سوداني", qty: "2 ملعقة كبيرة", kcal: 190 },
        { food: "كوب عصير فواكه طبيعي", qty: "1 كوب", kcal: 100 },
      ],
      preWorkout: [
        { food: "موزة كبيرة", qty: "1", kcal: 120 },
        { food: "زبادي قليل الدسم", qty: "150 غ", kcal: 90 },
      ],
      postWorkout: [
        { food: "صدر دجاج مشوي", qty: "150 غ", kcal: 250 },
        { food: "أرز بني", qty: "100 غ", kcal: 130 },
      ],
      lunch: [
        { food: "لحم بقري قليل الدهن", qty: "180 غ", kcal: 370 },
        { food: "بطاطا مشوية", qty: "150 غ", kcal: 130 },
        { food: "سلطة خضراء", qty: "120 غ", kcal: 50 },
      ],
      dinner: [
        { food: "سمك مشوي", qty: "150 غ", kcal: 250 },
        { food: "خضار مطهوة", qty: "150 غ", kcal: 80 },
        { food: "تفاحة", qty: "1", kcal: 80 },
      ],
      snacks: [
        { food: "مكسرات مشكلة", qty: "25 غ", kcal: 150 },
      ],
    },
  ],
  1800: [
    {
      breakfast: [
        { food: "4 بيضات أومليت", qty: "4 بيضات", kcal: 280 },
        { food: "توست بر", qty: "3 قطع", kcal: 240 },
        { food: "زبدة فول سوداني", qty: "2 ملعقة كبيرة", kcal: 190 },
        { food: "كوب عصير فواكه طبيعي", qty: "1 كوب", kcal: 100 },
      ],
      preWorkout: [
        { food: "موزة كبيرة", qty: "1", kcal: 120 },
        { food: "زبادي قليل الدسم", qty: "150 غ", kcal: 90 },
      ],
      postWorkout: [
        { food: "صدر دجاج مشوي", qty: "180 غ", kcal: 300 },
        { food: "أرز بني", qty: "120 غ", kcal: 150 },
      ],
      lunch: [
        { food: "لحم بقري قليل الدهن", qty: "200 غ", kcal: 400 },
        { food: "بطاطا مشوية", qty: "200 غ", kcal: 180 },
        { food: "سلطة خضراء", qty: "150 غ", kcal: 60 },
      ],
      dinner: [
        { food: "سمك مشوي", qty: "180 غ", kcal: 300 },
        { food: "خضار مطهوة", qty: "180 غ", kcal: 100 },
        { food: "تفاحة", qty: "1", kcal: 80 },
      ],
      snacks: [
        { food: "مكسرات مشكلة", qty: "30 غ", kcal: 180 },
      ],
    },
  ],
  2200: [
    {
      breakfast: [
        { food: "5 بيضات أومليت", qty: "5 بيضات", kcal: 350 },
        { food: "توست بر", qty: "3 قطع", kcal: 240 },
        { food: "زبدة فول سوداني", qty: "3 ملعقة كبيرة", kcal: 280 },
        { food: "كوب عصير فواكه طبيعي", qty: "1 كوب", kcal: 100 },
      ],
      preWorkout: [
        { food: "موزتين كبيرتين", qty: "2", kcal: 240 },
        { food: "زبادي قليل الدسم", qty: "200 غ", kcal: 120 },
      ],
      postWorkout: [
        { food: "صدر دجاج مشوي", qty: "200 غ", kcal: 350 },
        { food: "أرز بني", qty: "150 غ", kcal: 200 },
      ],
      lunch: [
        { food: "لحم بقري قليل الدهن", qty: "250 غ", kcal: 460 },
        { food: "بطاطا مشوية", qty: "250 غ", kcal: 220 },
        { food: "سلطة خضراء", qty: "150 غ", kcal: 60 },
      ],
      dinner: [
        { food: "سمك مشوي", qty: "200 غ", kcal: 350 },
        { food: "خضار مطهوة", qty: "200 غ", kcal: 120 },
        { food: "تفاحة", qty: "1", kcal: 80 },
      ],
      snacks: [
        { food: "مكسرات مشكلة", qty: "35 غ", kcal: 210 },
      ],
    },
  ],
};

function roundCalories(kcal) {
  const keys = Object.keys(mealsData).map(x => parseInt(x));
  let nearest = keys[0];
  let minDiff = Math.abs(kcal - nearest);
  for (const k of keys) {
    const diff = Math.abs(kcal - k);
    if (diff < minDiff) {
      minDiff = diff;
      nearest = k;
    }
  }
  return nearest;
}

function calculateBMR(weight, height, age, gender) {
  if (gender === "male") {
    return 10 * weight + 6.25 * height - 5 * age + 5;
  } else if (gender === "female") {
    return 10 * weight + 6.25 * height - 5 * age - 161;
  }
  // لن نستخدم خيار ثالث الآن بسبب التبسيط
  return 10 * weight + 6.25 * height - 5 * age; 
}

function generatePlan(bandCalories) {
  const dayPlans = [];
  const baseMeal = mealsData[bandCalories][0];
  for (let day = 1; day <= 30; day++) {
    dayPlans.push({ day, meals: baseMeal });
  }
  return dayPlans;
}

function formatMeal(name, items) {
  let total = 0;
  let lines = [`${name}:`];
  for (const item of items) {
    lines.push(`  • ${item.qty} ${item.food} (${item.kcal} سعره حرارية)`);
    total += item.kcal;
  }
  lines.push(`  مجموع السعرات: ${total} سعره حرارية\n`);
  return lines.join("\n");
}

function renderPlan(age, gender, height, weight, activity, goal) {
  const bmr = calculateBMR(weight, height, age, gender);
  let tdee = Math.round(bmr * activity);
  if (goal === "lose") tdee = Math.round(tdee - 500);
  else if (goal === "gain") tdee = Math.round(tdee + 400);
  if (tdee < 1200) tdee = 1200;

  const band = roundCalories(tdee);
  const bmi = (weight / ((height / 100) ** 2)).toFixed(1);
  const planDays = generatePlan(band);

  let outputLines = [];
  outputLines.push(`العمر: ${age} سنة`);
  outputLines.push(`الجنس: ${gender === "male" ? "ذكر" : "أنثى"}`);
  outputLines.push(`الطول: ${height} سم`);
  outputLines.push(`الوزن: ${weight} كغ`);
  outputLines.push(`مستوى النشاط: ${activity}`);
  outputLines.push(`الهدف: ${goal}`);
  outputLines.push(``);
  outputLines.push(`معدل الأيض الأساسي (BMR): ${Math.round(bmr)} سعره حرارية`);
  outputLines.push(`معدل السعرات اليومية الموصى بها (TDEE): ${tdee} سعره حرارية`);
  outputLines.push(`BMI: ${bmi}`);
  outputLines.push(``);
  outputLines.push(`خطة غذائية تفصيلية لمدة 30 يوم:\n`);

  planDays.forEach(({ day, meals }) => {
    outputLines.push(`اليوم ${day}:`);
    outputLines.push(formatMeal("الفطور", meals.breakfast));
    outputLines.push(formatMeal("وجبة قبل التمرين", meals.preWorkout));
    outputLines.push(formatMeal("وجبة بعد التمرين", meals.postWorkout));
    outputLines.push(formatMeal("الغداء", meals.lunch));
    outputLines.push(formatMeal("العشاء", meals.dinner));
    outputLines.push(formatMeal("السناكات", meals.snacks));
    outputLines.push(``);
  });

  return outputLines.join("\n");
}

document.getElementById("generateBtn").addEventListener("click", () => {
  const age = parseInt(document.getElementById("age").value);
  const gender = document.getElementById("gender").value;
  const height = parseInt(document.getElementById("height").value);
  const weight = parseInt(document.getElementById("weight").value);
  const activity = parseFloat(document.getElementById("activity").value);
  const goal = document.getElementById("goal").value;

  if (!age || !gender || !height || !weight || !activity || !goal) {
    alert("يرجى تعبئة جميع الحقول بشكل صحيح.");
    return;
  }

  const planText = renderPlan(age, gender, height, weight, activity, goal);
  const output = document.getElementById("output");
  output.style.display = "block";
  output.textContent = planText;
  window.scrollTo({ top: output.offsetTop, behavior: "smooth" });
});
</script>

</body>
</html>
